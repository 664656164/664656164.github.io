<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>我的技术与生活——学习javaweb框架 | 欢迎来到小韩的学习博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="shortcut icon" href="/imgs/shortcut-icon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/css/public.css" />
  <link rel="stylesheet" href="/css/layout.css" />
  <link rel="stylesheet" href="/css/iconfont.css" />
  <link rel="stylesheet" href="/css/APlayer.min.css" />
  <script src="/js/APlayer.min.js"></script>
  <script src="/js/jquery.min.js"></script>
  <script src="/js/jquery.pjax.min.js"></script>

  <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
  <script>
    document.title = `我的技术与生活——学习javaweb框架`
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>

<style>
  .load {
    width: 100%;
    height: 100vh;
    background-color: rgb(37, 35, 40);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: relative;
    z-index: 9999;
  }
  .load-circle {
    width: 80px;
    height: 80px;
    border: 8px solid orange;
    border-bottom-color: transparent;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    animation: rotate 1s linear infinite;
    filter: drop-shadow(0 0 3px orange);
  }
  .load-circle-inner {
    width: 40px;
    height: 40px;
    border: 8px solid orange;
    border-top-color: transparent;
    border-radius: 50%;
    animation: rotate-reverse .5s linear infinite;
  }
  .load-text {
    margin-top: 20px;
    font-size: 24px;
    color: orange;
    display: flex;
  }
  .load-text span {
    margin: 0 5px;
    text-shadow: 5px 5px 5px orange;
    animation: move 1s linear infinite;
  }
  .load-text span:nth-child(1) {
    animation-delay: -0.6s;
  }
  .load-text span:nth-child(2) {
    animation-delay: -0.5s;
  }
  .load-text span:nth-child(3) {
    animation-delay: -0.4s;
  }
  .load-text span:nth-child(4) {
    animation-delay: -0.3s;
  }
  .load-text span:nth-child(5) {
    animation-delay: -0.2s;
  }
  .load-text span:nth-child(6) {
    animation-delay: -0.1s;
  }
  @keyframes rotate {
    0% { transform: rotate(0); }
    100% { transform: rotate(360deg); }
  }
  @keyframes rotate-reverse {
    0% { transform: rotate(0); }
    100% { transform: rotate(-360deg); }
  }
  @keyframes move {
    0% { transform: translateY(0%) rotate(0) scale(1); }
    20% { transform: translateY(20%) rotate(10deg) scale(1.2); }
    80% { transform: translateY(-10%) rotate(-20deg) scale(.8);}
    100% { transform: translateY(0) rotate(0) scale(1); }
  }

  .progress {
    position: fixed;
    left: 0; top: 0;
    width: 0;
    height: 3px;
    background-color: green;
    transition: all cubic-bezier(0.215, 0.610, 0.355, 1) .1s;
    z-index: 9999;
  }

  .to-up {
    animation: toUp .5s 1;
  }
  .gray {
    position: fixed;
    left: 0;
    top: 0;
    width: 100%;
    height: 100vh;
    z-index: 9999;
    display: none;
    pointer-events: none;
    background-color: #000;
    mix-blend-mode: color;
  }
  @keyframes toUp {
    from { transform: translateY(15px); opacity: 0; }
    to { transform: translateY(0) ; opacity: 1; }
  }
</style>
<body>
  <div id="load" class="load">
    <div class="load-circle">
      <div class="load-circle-inner"></div>
    </div>
    <p class="load-text">
      <span>L</span>
      <span>O</span>
      <span>A</span>
      <span>D</span>
      <span>I</span>
      <span>N</span>
      <span>G</span>
    </p>
  </div>
  <div id="container" class="container w-100 vh-100" style="display: none;">
    <header class="header">
  <div class="header-wrapper">
    <div class="header-left">
      <div class="header-search">
        <input id="search-input" type="text" class="header-search--input" placeholder="请输入要检索的文章标题" />
        <span id="search-btn" class="header-search--icon"><i class="iconfont icon-sousuo"></i></span>
      </div>
      <div id="search-layer" class="header-search--layer hidden">
        <p class="title">
          <span>以下是搜索内容：</span>
          <span id="close-layer-btn">关闭</span>
        </p>
        <ul>
        </ul>
      </div>
    </div>
    <div class="header-right">
      <ul class="header-menu">
        <li>
          <a href="http://example.com/">
            <i class="header-menu--icon iconfont icon-shouye"></i>
            <span class="header-menu--span">首页</span>
          </a>
        </li>
        <li>
          <a href="http://example.com/log">
            <i class="header-menu--icon iconfont icon-rizhi"></i>
            <span class="header-menu--span">日志</span>
          </a>
        </li>
        <li>
          <a href="http://example.com/link">
            <i class="header-menu--icon iconfont icon-youqinglianjie"></i>
            <span class="header-menu--span">友情链接</span>
          </a>
        </li>
        <li>
          <a href="http://example.com/about">
            <i class="header-menu--icon iconfont icon-guanyuwomen"></i>
            <span class="header-menu--span">关于我</span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</header>

<script>
  const ipt = document.querySelector('#search-input')
  const btn = document.querySelector('#search-btn')
  const layer = document.querySelector('#search-layer')
  const posts = JSON.parse(`[{"title":"学习javaweb基础","cover":"/images/javaweb-cover.jpg","path":"2024/03/27/JAVA WEB/"},{"title":"c++竞赛","cover":"/images/c++.jpg","path":"2023/03/27/ACM暑假集训笔记/"},{"title":"python应用","cover":"/images/python.jpg","path":"2024/04/03/Python/"},{"title":"学习javaweb框架","cover":"/images/javaweb-cover.jpg","path":"2024/11/27/JAVAWEB框架/"},{"title":"学习git指令","cover":"/images/git.jpg","path":"2024/04/11/git项目管理工具/"},{"title":"python基础","cover":"/images/python.jpg","path":"2024/05/12/python详细版本/"},{"title":"学习Redis","cover":"/images/redis-cover.jpg","path":"2025/03/27/学习Redis/"},{"title":"mysql","cover":"/images/mysql.jpg","path":"2023/10/25/数据库知识/"},{"title":"微信小程序","cover":"/images/wx.jpg","path":"2024/09/09/微信小程序/"}]`)
  ipt.addEventListener('keyup', e => {
    if (e.key === 'Enter') {
      handleSearch()
    }
  })
  btn.addEventListener('click', () => {
    handleSearch()
  })

  document.querySelector('#close-layer-btn').addEventListener('click', () => {
    layer.classList.toggle('hidden')
  })

  function handleSearch() {
    if (ipt.value.trim() === '') {
      return
    }
    let html = ''
    const targetPosts = posts.filter(post => post.title.includes(ipt.value))
    targetPosts.forEach(post => {
      html += `
        <li>
          <div>
            <a href="/${post.path}">${post.title.replace(new RegExp(ipt.value), `<span>${ipt.value}</span>`)}</a>
          </div>
          <img src="${post.cover || '/imgs/default-cover.webp' }" />
        </li>
      `
    })
    if (html.trim () === '') {
      html += '<p class="empty">没有搜索到内容</p>'
    }
    layer.querySelector('ul').innerHTML = html
    layer.classList.remove('hidden')
  }
</script> 
    <section id="main" class="main">
      <div class="main-left-wrapper">
<div class="main-left">
  <div class="main-left--block">
    <div class="main-left--info">
      <img src="/imgs/avatar.jpg"" class="main-left--avatar" />
      <div class="main-left--intro">
        <p class="main-left--name">gcbsh</p>
        <div class="main-left--tags">
          <span class="main-left--tag">减肥</span>
          <span class="main-left--tag">学习</span>
        </div>
      </div>
    </div>
  
    <div>
      <div class="main-left--motto">
        <p>“关关难过关关过，前路漫漫亦灿灿”</p>
        <p>“愿望是宅家睡大觉”</p>
      </div>
      <div class="main-left--github">
        <span class="line"></span>
        <a target="_blank" rel="noopener" href="https://github.com/664656164"><i class="logo iconfont icon-github-fill"></i></a>
        <span class="line"></span>
      </div>
      <div class="main-left--statics">
        <a href="/categories">
          <div>
            <span>7</span>
            <span>分类</span>
          </div>
        </a>
        <a href="/tags">
          <div>
            <span>0</span>
            <span>标签</span>
          </div>
        </a>
        <a href="/archives">
          <div>
            <span>8 </span>
            <span>归档</span>
          </div>
        </a>
      </div>
    </div>
  </div>

  <div class="main-left--block">
    <ul class="main-left--menu">
      
        <li>
          <a href="/">
            <span class="header-menu--span">小站首页</span>
            <i class="header-menu--icon iconfont icon-shouye"></i>
          </a>
        </li>
      
        <li>
          <a href="/log">
            <span class="header-menu--span">个人日志</span>
            <i class="header-menu--icon iconfont icon-rizhi"></i>
          </a>
        </li>
      
        <li>
          <a href="/link">
            <span class="header-menu--span">友情链接</span>
            <i class="header-menu--icon iconfont icon-youqinglianjie"></i>
          </a>
        </li>
      
        <li>
          <a href="/about">
            <span class="header-menu--span">关于自己</span>
            <i class="header-menu--icon iconfont icon-guanyuwomen"></i>
          </a>
        </li>
      
        <li>
          <a href="/tools">
            <span class="header-menu--span">我的工具</span>
            <i class="header-menu--icon iconfont icon-gongju"></i>
          </a>
        </li>
      
    </ul>
  </div>

  <div class="main-left--block">
    <div class="main-left--site">
      <h5 class="main-left--title">
        <span>站点信息</span>
        <i class="iconfont icon-zhandian"></i>
      </h5>
      <p class="main-left--subtitle">
        <span>文章数目：</span>
        <span>9 篇</span>
      </p>
      <p class="main-left--subtitle">
        <span>最近动态：</span>
        <span>今天</span>
      </p>
      <p class="main-left--subtitle">
        <span>上线时间：</span>
        <span>2天</span>
      </p>
      <p class="main-left--subtitle">
        <span>当前版本：</span>
        <span>v1.0.2</span>
      </p>
    </div>
  </div>
</div></div>
      <div id="main-container" class="main-container">


  <link rel="stylesheet" href="/css/partial/article.css" />

<div class="article-container">
  <div class="article">
    <h1 class="article-title">学习javaweb框架</h1>
    <div class="article-info">
      <div class="article-info--item">
        <div class="article-info--info">
          
          <div class="article-info--categories">
            <span>分类：</span>
            <a class="category-link" href="/categories/javaweb/">Javaweb</a>
          </div>
          
          
          <div class="article-info--tags">
            <span>标签：</span>
            
          </div>
          
          <p class="article-info--date">日期：2024-11-27 00:00:00</p>
        </div>
        <img src="/images/javaweb-cover.jpg" alt="" class="article-cover">
      </div>
    </div>
    <article class="article-content markdown-body">
      <h1 id="JAVAWEB框架"><a href="#JAVAWEB框架" class="headerlink" title="JAVAWEB框架"></a>JAVAWEB框架</h1><p>**学习：spring springmvc springboot **</p>
<p>Java Web框架技术1<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/YSO8QHOl">https://note.youdao.com/s/YSO8QHOl</a></p>
<p>Java Web框架技术2  Spring配置<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/12y4bXwo">https://note.youdao.com/s/12y4bXwo</a></p>
<p>【Java Web框架技术3】   Spring中Bean的生命周期和作用域<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/H6jj6wrJ">https://note.youdao.com/s/H6jj6wrJ</a></p>
<p>Java Web框架技术4   控制反转和依赖注入<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/cSYkA2gg">https://note.youdao.com/s/cSYkA2gg</a></p>
<p>Java Web框架技术5 全注解Spring开发<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/CAi6Ldsc">https://note.youdao.com/s/CAi6Ldsc</a></p>
<p>Java Web框架技术6  AOP<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/POXpyrWV">https://note.youdao.com/s/POXpyrWV</a></p>
<p>Java Web框架技术7 JdbcTemplelate+事物<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/MFRoeI9J">https://note.youdao.com/s/MFRoeI9J</a></p>
<p>Java Web框架技术8   SpringMVC<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/Ym2Rc5Fx">https://note.youdao.com/s/Ym2Rc5Fx</a></p>
<p>JavaWeb 框架技术9  Spring MVC参数传递+综合案例<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/Nsijd2kq">https://note.youdao.com/s/Nsijd2kq</a></p>
<p>JavaWeb 框架技术11  spring boot<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/43dymWda">https://note.youdao.com/s/43dymWda</a></p>
<p>JavaWeb 框架技术12  配置文件和Lombok<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/5ObFIjZh">https://note.youdao.com/s/5ObFIjZh</a></p>
<p>JavaWeb 框架技术13  Spring Boot + Mybatis<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/CwDoAGb0">https://note.youdao.com/s/CwDoAGb0</a></p>
<p>JavaWeb 框架技术14  Spring Boot + Mybatis Plus<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/PeoW7QGg">https://note.youdao.com/s/PeoW7QGg</a></p>
<p>JavaWeb 框架技术15 Spring Boot整合Thymeleaf<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/4ilRFYkQ">https://note.youdao.com/s/4ilRFYkQ</a></p>
<p>JavaWeb 框架技术16  Spring Boot统一返回值封装与异常处理<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/HRwkuvoB">https://note.youdao.com/s/HRwkuvoB</a></p>
<p>JavaWeb 框架技术17  Spring Boot 拦截器<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/25MN98g0">https://note.youdao.com/s/25MN98g0</a></p>
<p>JavaWeb 框架技术18  异步任务+定时任务<br><a target="_blank" rel="noopener" href="https://note.youdao.com/s/BiD6w1jC">https://note.youdao.com/s/BiD6w1jC</a></p>
<h1 id="一-学习spring"><a href="#一-学习spring" class="headerlink" title="一.学习spring"></a>一.学习spring</h1><h2 id="1-了解Spring"><a href="#1-了解Spring" class="headerlink" title="1.了解Spring"></a>1.了解Spring</h2><p>spring框架是一个开源的轻量级java开发框架，核心是IOC（inversion of Control控制反转）和AOP面向切面编程（用于日志和事务）</p>
<p>spring就是一个大工厂，可以将所有对象的创建和依赖关系的维护交给spring管理。</p>
<p><strong>spring的作用：1）管理bean对象</strong></p>
<p>​                          <strong>2）管理bean与bean之间的依赖关系</strong></p>
<h2 id="2-创建一个spring项目"><a href="#2-创建一个spring项目" class="headerlink" title="2.创建一个spring项目"></a>2.创建一个spring项目</h2><p>new project</p>
<p><img src="/images/image-20240924160108332.png%22" alt="javaweb架构图"></p>
<p>配置maven</p>
<p><img src="/images/image-20240924160133176.png%22" alt="javaweb架构图"></p>
<p>删除Src</p>
<p><img src="/images/image-20240924160203671.png%22" alt="javaweb架构图"></p>
<p>创建子工程</p>
<p><img src="/images/image-20240924160438418.png%22" alt="javaweb架构图"></p>
<p>在父工程中导入依赖</p>
<p><img src="/images/image-20240924160626868.png%22" alt="javaweb架构图"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 引入spring-context依赖会自动引入aop、beans、core、expression基础依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.1.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 引入单元测试依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>创建application.xml</p>
<p><img src="/images/image-20240924160921181.png%22" alt="javaweb架构图"></p>
<h2 id="3-Spring配置文件application-xml-5个标签"><a href="#3-Spring配置文件application-xml-5个标签" class="headerlink" title="3.Spring配置文件application.xml(5个标签)"></a>3.Spring配置文件application.xml(5个标签)</h2><p>application.xml有五个标签：1】beans根标签  作用:1）命名空间+约束 2）区分开发环境（根据profile配置环境 dev开发环境 test测试环境 prod生产环境 profile&#x3D;”profile”）</p>
<p>​                                               2】<strong>bean核心标签</strong> —&gt;对象 <bean id="唯一的id" class="Java类名"/>等价于User user &#x3D; new User()</p>
<p>​                                                                        bean的作用域</p>
<p>​                                                                        bean的生命周期</p>
<p>​                                                                        bean的懒加载 默认情况下，bean对象在spring容器创建时，同步创建出bean对象。所谓的懒加载，时推迟bean对象的创建，在第一次使用时创建，也就是获取bean对象时。&#x3D;》 <bean id="唯一的id" class="Java类名" lazy-init="true"/> </p>
<p>​                                                                             <bean id="xiaohan" class="User"><br>​                                                                                                   <property name="name" value="zhangsan"/><br>​                                                                                                    <!--        相当于xiaohan.setname("zhangsan")--><br>​                                                                                    </bean></p>
<p>​                                                                              <strong>上面的bean等价于下面的java代码：</strong></p>
<p>​                                                                               User xiaohan &#x3D; new User();</p>
<p>​                                                                               xiaohan.setName(“zhangsan”);</p>
<p>​                                               3】<strong>import标签</strong> 导入其他xml配置 </p>
<p>​                                               4】description标签 注释相当于<!-- 注释信息 --></p>
<p>​                                               5】<strong>alias标签</strong> 取别名<alias name="bean的id名" alias="别名"/></p>
<h2 id="4-获取bean对象三种方式"><a href="#4-获取bean对象三种方式" class="headerlink" title="4.获取bean对象三种方式"></a>4.获取bean对象三种方式</h2><h3 id="1）传入id"><a href="#1）传入id" class="headerlink" title="1）传入id"></a>1）传入id</h3><h3 id="2-类-class类型"><a href="#2-类-class类型" class="headerlink" title="2)类.class类型"></a>2)类.class类型</h3><h3 id="3）id-类-class-常用"><a href="#3）id-类-class-常用" class="headerlink" title="3）id,类.class(常用)"></a>3）<strong>id,类.class(常用)</strong></h3><p><img src="/images/image-20240929163549656.png" alt="javaweb架构图"></p>
<p><img src="/images/image-20240929155448799.png" alt="javaweb架构图"></p>
<h2 id="5-bean的生命周期（5个阶段）"><a href="#5-bean的生命周期（5个阶段）" class="headerlink" title="5.bean的生命周期（5个阶段）"></a>5.bean的生命周期（5个阶段）</h2><p>bean的生命周期是指bean被创建到被销毁的整个过程。</p>
<p>（1）创建bean对象（调用无参构造器）</p>
<p>（2）设置bean对象属性</p>
<p>（3）初始化bean对象（自定义init方法 配置bean属性:init-method&#x3D;”方法名”）</p>
<p>（4）bean对象准备就绪可以使用</p>
<p>（5）销毁bean对象(只有当IOC容器关闭时，才可以销毁bean对象)（自定义destory方法 配置bean属性:destory-method&#x3D;”方法名”）</p>
<h2 id="6-bean的生命周期（7个阶段–重点掌握）"><a href="#6-bean的生命周期（7个阶段–重点掌握）" class="headerlink" title="6.bean的生命周期（7个阶段–重点掌握）"></a>6.bean的生命周期（7个阶段–重点掌握）</h2><p>（1）创建bean对象（调用无参构造器）</p>
<p>（2）设置bean对象属性</p>
<p><strong>（3）执行初始化之前逻辑</strong> （Spring提供了逻辑处理的接口 BeanPostProcessor）</p>
<p>（4）初始化bean对象（自定义init方法 配置bean属性:init-method&#x3D;”方法名”）</p>
<p><strong>（5）执行初始化之后逻辑</strong></p>
<p>（6）bean对象准备就绪可以使用</p>
<p>（7）销毁bean对象(只有当IOC容器关闭时，才可以销毁bean对象)（自定义destory方法 配置bean属性:destory-method&#x3D;”方法名”）</p>
<p><img src="/images/image-20241008154512271.png" alt="javaweb架构图"></p>
<h2 id="7-bean的作用域"><a href="#7-bean的作用域" class="headerlink" title="7.bean的作用域"></a>7.bean的作用域</h2><p>bean的scope属性指定bean的作用域，其属性值有：Singleton(单例-默认) Prototype(原型)….</p>
<p><img src="/images/image-20241008154407832.png" alt="javaweb架构图"></p>
<p><strong>注意</strong>：</p>
<p><img src="/images/image-20241012151047537.png" alt="javaweb架构图"></p>
<h2 id="8-IOC（控制反转）"><a href="#8-IOC（控制反转）" class="headerlink" title="8.IOC（控制反转）"></a>8.IOC（控制反转）</h2><p>控制：对象的创建和对象之间的关系。</p>
<p><strong>IOC控制反转实现方式2种：</strong></p>
<p>​                       【1】DL依赖查找（基本淘汰）</p>
<p>​                       【2】<strong>DI依赖注入</strong>（<strong>给对象的属性赋值</strong>）（JAVA通过sertter方法和构造方法给对象的属性赋值）</p>
<p>​                                                          DI依赖注入俩种实现方式：1）构造器注入(有参)    2）set方法注入</p>
<p>​                                 </p>
<h2 id="9-DI依赖注入2种方式"><a href="#9-DI依赖注入2种方式" class="headerlink" title="9.DI依赖注入2种方式"></a>9.DI依赖注入2种方式</h2><h3 id="1）构造器注入（有参）constructor-arg"><a href="#1）构造器注入（有参）constructor-arg" class="headerlink" title="1）构造器注入（有参）constructor-arg"></a>1）构造器注入（有参）constructor-arg</h3><p>通过构造函数传递依赖对象。利用类的构造函数为类对象属性赋值，<strong>类必须要有有参构造函数</strong>。<strong>constructor-arg</strong></p>
<p><img src="/images/image-20241012150830070.png" alt="javaweb架构图"></p>
<p><strong>【★】用C命名空间注入简化构造器注入</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  &lt;bean id=<span class="string">&quot;t1&quot;</span> class=<span class="string">&quot;constructor.Teacher&quot;</span>&gt;</span><br><span class="line">&lt;!--        property是通过setter方法赋值--&gt;</span><br><span class="line">&lt;!--        constructor-arg通过有参构造方法赋值--&gt;</span><br><span class="line">        &lt;constructor-arg name=<span class="string">&quot;tnum&quot;</span> value=<span class="string">&quot;1&quot;</span>&gt;&lt;/constructor-arg&gt;</span><br><span class="line">        &lt;constructor-arg name=<span class="string">&quot;tname&quot;</span> value=<span class="string">&quot;zhangsan&quot;</span>&gt;&lt;/constructor-arg&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<p><strong>用c命名空间注入简化为</strong>：<bean id="t1" class="constructor.Teacher" c:tname="zhangsan" c:tnum="1"/></p>
<h3 id="2）setter方法注入-property"><a href="#2）setter方法注入-property" class="headerlink" title="2）setter方法注入 property"></a>2）setter方法注入 property</h3><p>通过setter方法传递依赖对象。利用类属性的setter方法为类对象属性赋值，<strong>类必须要用set方法</strong>。<strong>property</strong></p>
<bean id="t1" class="constructor.Teacher">

<p>​              <property name="tname" value="zhangsan"/></p>
<p>​             <property name="tnum" value="1"/></p>
</bean>

<p><strong>【★】用p命名空间注入简化setter注入</strong></p>
<p><strong>用p命名空间注入简化为</strong>：<bean id="t1" class="constructor.Teacher" p:tname="zhangsan" p:tnum="1"></p>
<h2 id="10-自动装配"><a href="#10-自动装配" class="headerlink" title="10.自动装配"></a>10.自动装配</h2><p><strong>【setter注入和自动装配重点】</strong></p>
<p>bean标签的autowire属性表示自动配置</p>
<p>属性值：byName 和 byType</p>
<p>​              1)byName(<strong>按名称自动配置</strong>)： 这种自动配置模式会尝试将一个Bean的属性与另一个Bean的名称（id）匹配。如果发现一个与属性名称相同的Bean,那么就会自动装配成功。</p>
<p><img src="/images/image-20241012173859228.png" alt="javaweb架构图"></p>
<p>​              2)byType(<strong>按类型自动配置</strong>)：这种自动装配模式会尝试将一个Bean的属性与另一个Bean的类型匹配。如果发现有且仅有一个Bean的类型与属性的类型匹配，那么就会自动装配成功。如果存在多个匹配的Bean，spring会抛出异常，因为无法确定应该使用哪一个Bean.</p>
<p><img src="/images/image-20241012173712787.png" alt="javaweb架构图"></p>
<p><strong>补充：</strong></p>
<p><img src="/images/image-20241012173949593.png" alt="javaweb架构图"></p>
<h2 id="11-Spring注解"><a href="#11-Spring注解" class="headerlink" title="11.Spring注解"></a>11.Spring注解</h2><p>![image-20241019151732919](C:\Users\韩俊兰\AppData\Roaming\Typora\typora-user-images\image-20241019151732919.png</p>
<h3 id="1）使用全注解方式开发"><a href="#1）使用全注解方式开发" class="headerlink" title="1）使用全注解方式开发"></a>1）使用全注解方式开发</h3><p>以前使用application.xml获取IOC容器 配置好XML文件 通过ApplicationContext context &#x3D; new <strong>ClassPathXmlApplicationContext</strong>(“Xml文件名.xml”)获取IOC容器。</p>
<p>如果想用全注解方式，第一步：应该利用**@Configuration**注解定义一个配置类 第二部：通过ApplicationContext context &#x3D; new <strong>AnnotationConfigApplicationContext</strong>(配置类类名.class)获取IOC容器。</p>
<p><img src="/images/image-20241015170951956.png" alt="javaweb架构图"></p>
<p><img src="/images/image-20241015171015668.png" alt="javaweb架构图"></p>
<h3 id="2）注解"><a href="#2）注解" class="headerlink" title="2）注解"></a>2）注解</h3><p>Java注解（Annotation）是一种元数据（metadata）标记，它们提供了<strong>对类、方法、字段、参数</strong>等元素的附加信息。注解通常以</p>
<p>@符号开头，放置在目标元素的前面，用于提供额外的信息给编译器、运行时环境或工具。Java开始支持注解是从Java 5版本（也称为Java 1.5）开始的。</p>
<p>Spring框架提供了多种注解，用于简化配置和管理Spring应用程序中的组件、依赖关系和事务等。Spring框架开始支持注解是从Spring 2.5版本开始的</p>
<p>java自定义组件 @Iterface</p>
<p>加在注解上的注解叫做原注解</p>
<h3 id="3）常用的Spring框架注解及其用途："><a href="#3）常用的Spring框架注解及其用途：" class="headerlink" title="3）常用的Spring框架注解及其用途："></a>3）常用的Spring框架注解及其用途：</h3><h4 id="1】声名Bean的注解"><a href="#1】声名Bean的注解" class="headerlink" title="1】声名Bean的注解"></a>1】声名Bean的注解</h4><p>​                                (创建对象，用于替换配置文件的bean标签)</p>
<p>​                                @Component(<strong>Spring创建这个类的对象出来</strong>)</p>
<p>​                                 —&gt;Component的特例版本：   Service(Service层) Repository（Dao  层） @Controller(Controller层)                                                                                                                                                                                        </p>
<h4 id="2】注入属性值"><a href="#2】注入属性值" class="headerlink" title="2】注入属性值"></a>2】注入属性值</h4><p>​                       @Value(“id”)就是给类定义id  也可以直接用@Service(“id”)定义</p>
<p>​                       <strong>如果没有给类定义id,则会自己给我们配置一个id(即类的首字母小写)</strong> 注入简单类型的数据值</p>
<p>​                       @Autowired 自动装配 其他Bean对象</p>
<p>​                       @Qualifier  （当一个接口有多个实现类时，用Autowired注解不知道自动装配哪一个接口的具体实现类，</p>
<p>​                                               因此可以用@Qualifier注解，指定实现类@Qualifier（“具体实现类”）推荐使用@Qualifier）</p>
<p>​                      注意：JAVA中提供了@Resource注解 是  @Autowired和 @Qualifier 的结合</p>
<p><img src="/images/image-20241015165904033.png" alt="javaweb架构图"></p>
<p>​                                 @Resource注解属于JDK扩展包，不在JDK当中，使用前需要额外引入以下依赖：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;jakarta.annotation&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jakarta.annotation-api&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">2.1</span><span class="number">.1</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>



<h4 id="3】其他的"><a href="#3】其他的" class="headerlink" title="3】其他的"></a>3】其他的</h4><p>​                  @Configuration用于定义Spring配置类（不用XML配置文件）</p>
<p>​                  @ComponentScan组件扫描 @ComponentScan(“包”) 扫描该包下的bean</p>
<p>​                  @Bean是将自己new的对象放进Spring容器中</p>
<h3 id="4）注解总结图"><a href="#4）注解总结图" class="headerlink" title="4）注解总结图"></a>4）注解总结图</h3><p><img src="/images/image-20241015161038863.png" alt="javaweb架构图"></p>
<h2 id="12-AOP"><a href="#12-AOP" class="headerlink" title="12.AOP"></a>12.AOP</h2><h3 id="1）基本概念"><a href="#1）基本概念" class="headerlink" title="1）基本概念"></a>1）基本概念</h3><p>AOP：在不改变原有代码逻辑的同时，可以增强原有代码的逻辑和功能。（日志记录，事务管理，安全性等）</p>
<p>​            AOP底层：使用动态代理来实现。（Spring的AOP使用的动态代理是JDK动态代理和CGLIB动态代理技术相结合）</p>
<p>AOP的优点：</p>
<p>​                     增强代码的可复用性。</p>
<p>​                     增强代码的可维护性。</p>
<p>​                     开发者只用关注业务逻辑的开发。</p>
<h3 id="2）使用AOP步骤："><a href="#2）使用AOP步骤：" class="headerlink" title="2）使用AOP步骤："></a>2）使用AOP步骤：</h3><p>​                       1.导入AspectJ依赖（Spring-Aop）</p>
<p>​                       2.切面类  1】类：@Aspect定义类为切面类</p>
<p>​                                       2】方法：@After @Before @Around @After Returning  @After Throwing +切入点表达式</p>
<p>​                        3.配置类 @EnableAspectJAutoproxy开启AOP</p>
<p><img src="/images/775E2847EBFF087A13753D761652C35F.jpg" alt="javaweb架构图"></p>
<h2 id="13-JDBCTemplate"><a href="#13-JDBCTemplate" class="headerlink" title="13.JDBCTemplate"></a>13.JDBCTemplate</h2><h2 id="Spring-框架提供的一个用于简化-JDBC-编程的工具类"><a href="#Spring-框架提供的一个用于简化-JDBC-编程的工具类" class="headerlink" title="(Spring 框架提供的一个用于简化 JDBC 编程的工具类)"></a>(Spring 框架提供的一个用于简化 JDBC 编程的工具类)</h2><h3 id="1）写一个JDBC工具类的步骤："><a href="#1）写一个JDBC工具类的步骤：" class="headerlink" title="1）写一个JDBC工具类的步骤："></a>1）写一个JDBC工具类的步骤：</h3><p>​              1.导包（导入mysql驱动包）</p>
<p>​              2.JdbcTool:  1）注册驱动（提供驱动名）  2）建立连接（提供url,username,password）3) 封装方法2个（增删改）和                   （查）4）关闭资源方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Dao.JDBC;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcUtils</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">pass</span> <span class="operator">=</span> <span class="string">&quot;hdl664656165&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">mysql</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/xiaohan&quot;</span>;</span><br><span class="line">    <span class="comment">//    注册驱动建立连接</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line">        Class.forName(driver);</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(mysql,user,pass);</span><br><span class="line">        <span class="keyword">return</span> conn;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    查询操作 查询返回的结果式结果集对象 Object... params表示可以传递多个参数</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ResultSet <span class="title function_">find</span><span class="params">(String sql, Object... params)</span> <span class="keyword">throws</span> SQLException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="comment">//        建立连接</span></span><br><span class="line">        conn = getConnection();</span><br><span class="line"><span class="comment">//        预编译</span></span><br><span class="line">        preparedStatement = conn.prepareStatement(sql);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; params.length; ++i) &#123;</span><br><span class="line">            preparedStatement.setObject(i + <span class="number">1</span>, params[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> preparedStatement.executeQuery();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    更新操作 增，删，改 insert delete update</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(String sql, Object... params)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = getConnection();</span><br><span class="line">            preparedStatement = conn.prepareStatement(sql);</span><br><span class="line"><span class="comment">//            System.out.println(&quot;=====&quot;);</span></span><br><span class="line">            <span class="type">int</span> i;</span><br><span class="line">            <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; params.length; ++i) &#123;</span><br><span class="line">                preparedStatement.setObject(i + <span class="number">1</span>, params[i]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            i = preparedStatement.executeUpdate();</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var10) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;执行更新操作失败&quot;</span>, var10);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            closeResources(conn,preparedStatement, (ResultSet)<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//    关闭资源</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">closeResources</span><span class="params">(Connection conn, PreparedStatement preparedStatement, ResultSet rs)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (rs != <span class="literal">null</span>) &#123;</span><br><span class="line">                rs.close();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (preparedStatement != <span class="literal">null</span>) &#123;</span><br><span class="line">                preparedStatement.close();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException var4) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;关闭资源失败&quot;</span>, var4);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2）使用JDBC-Template的步骤"><a href="#2）使用JDBC-Template的步骤" class="headerlink" title="2）使用JDBC Template的步骤"></a>2）使用JDBC Template的步骤</h3><p>1】导包（mysql驱动+spring-jdbc）</p>
<p>2】springConfig(配置类)：数据源</p>
<p>​                                           创建JdbcTemplate对象</p>
<p>3】实体类（与数据库表名字段名相同的实体类）</p>
<p>4】DAO层：接口</p>
<p>​                     实现类 封装SQL语句  JdbcTemplate的核心方法：update方法：执行insert,update,delete</p>
<p>​                                                                                                      query方法：用于执行查询操作，并返回结果集（一般用List接收）</p>
<p>​                                                                                                       queryForObject方法：用于执行查询操作，并返回单一结果（返回一个实体类对象）</p>
<p>5】service层 接口，实现类</p>
<p>6】controller层</p>
<p>7】测试代码Test</p>
<p>补充：当进行如转账等操作时，需要维持事务的原子性（事务是一个不可分割的工作单元，要么都执行，要么都不执行）</p>
<p>在类上添加事务注解@Transactional    在配置类上添加@EnableTransactionManagement开启事务</p>
<p> 在配置类上配置事务管理器</p>
<p>eg.配置类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.datasource.DataSourceTransactionManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.datasource.DriverManagerDataSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.EnableTransactionManagement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义配置类</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//扫描</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.example&quot;)</span></span><br><span class="line"><span class="comment">//开启事务</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountConfig</span> &#123;</span><br><span class="line">    <span class="comment">//数据源(DriverManagerDataSource)</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">createDataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DriverManagerDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DriverManagerDataSource</span>();</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/javaweb&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;hdl664656165&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建JDBCTemplate对象</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> JdbcTemplate <span class="title function_">createJdbcTemplate</span><span class="params">(DataSource dataSource)</span>&#123;</span><br><span class="line">        <span class="type">JdbcTemplate</span> <span class="variable">jdbcTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JdbcTemplate</span>(dataSource);</span><br><span class="line">        <span class="keyword">return</span> jdbcTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//配置事务管理器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSourceTransactionManager <span class="title function_">dataSourceTransactionManager</span><span class="params">(DataSource dataSource)</span>&#123;</span><br><span class="line">        <span class="type">DataSourceTransactionManager</span> <span class="variable">dataSourceTransactionManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataSourceTransactionManager</span>();</span><br><span class="line">        dataSourceTransactionManager.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span>  dataSourceTransactionManager;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//eg.dao层实现类</span></span><br><span class="line"><span class="keyword">import</span> com.example.Account;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.BeanPropertyRowMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountDao</span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">updateAccountById</span><span class="params">(Double balance,Integer accountId)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span><span class="string">&quot;update javaweb.t_account set balance= ?where accountId= ?;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> jdbcTemplate.update(sql,balance,accountId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    注意查询的时候 jdbcTemplate的query方法 返回的是list select * from 数据表；</span></span><br><span class="line"><span class="comment">//                jdbcTemplate的queryForObject方法 返回的Object对象 利用new BeanPropertyRowMapper&lt;&gt;(类名.class) 反射出一个对应的类</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Account <span class="title function_">getAccountById</span><span class="params">(Integer accountId)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span><span class="string">&quot;select * from javaweb.t_account where accountId = ?;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> jdbcTemplate.queryForObject(sql,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;accountId&#125;,<span class="keyword">new</span> <span class="title class_">BeanPropertyRowMapper</span>&lt;&gt;(Account.class));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="二-Spring-MVC"><a href="#二-Spring-MVC" class="headerlink" title="二.Spring MVC"></a>二.Spring MVC</h1><h2 id="1-前景知识"><a href="#1-前景知识" class="headerlink" title="1.前景知识"></a>1.前景知识</h2><p>Spring有俩种开发方式：1) xml      2) 注解@+config类   </p>
<p>SpringMvc也有这俩种方式：1) xml      2) 注解@+config类   </p>
<p>MVC：model-&gt;对应service+dao  view和controller–&gt;controller           三层架构：dao  service controller</p>
<p>Spring会管理三层架构之间每一层的对象之间的依赖关系。</p>
<h2 id="2-回顾Servlet"><a href="#2-回顾Servlet" class="headerlink" title="2.回顾Servlet"></a>2.回顾Servlet</h2><h3 id="创建Servlet项目"><a href="#创建Servlet项目" class="headerlink" title="创建Servlet项目"></a>创建Servlet项目</h3><p><img src="/images/image-20241022155059109.png%22" alt="javaweb架构图"></p>
<p>补全：文件</p>
<p><img src="/images/image-20241022155201578.png%22" alt="javaweb架构图"></p>
<h3 id="部署Tomcat"><a href="#部署Tomcat" class="headerlink" title="部署Tomcat"></a>部署Tomcat</h3><p><img src="/images/image-20241022153723593.png" alt="javaweb架构图"></p>
<p><img src="/images/image-20241022153800099.png%22" alt="javaweb架构图"></p>
<p><img src="/images/image-20241022154819240.png" alt="javaweb架构图"></p>
<p><img src="/images/image-20241022153854839.png%22" alt="javaweb架构图"></p>
<p><img src="/images/image-20241022153911217.png" alt="javaweb架构图"></p>
<p><img src="/images/image-20241022153953617.png%22" alt="javaweb架构图"></p>
<p>注意：在WEB-INF的文件，不能通过浏览器访问，webapp下的文件，才可以通过浏览器访问。</p>
<h2 id="3-SpringMvc常用开发注解"><a href="#3-SpringMvc常用开发注解" class="headerlink" title="3.*SpringMvc常用开发注解"></a>3.*SpringMvc常用开发注解</h2><h3 id="1）-Controller"><a href="#1）-Controller" class="headerlink" title="1）@Controller"></a>1）@Controller</h3><p> 用于标识一个类为Spring MVC控制器，这意味着这个类将接收和处理来着客户端的HTTP请求</p>
<h3 id="2）-RequestMapping"><a href="#2）-RequestMapping" class="headerlink" title="2）@RequestMapping"></a>2）@RequestMapping</h3><p>配置请求的<strong>映射路径，Http方法</strong>和其他属性（在以前的Servlet种用的@WebServlet()只能放在类上）</p>
<p>​     @RequestMapping非常灵活，可以放在类上以及方法上 </p>
<p>​          属性：name&#x2F;path:配置路径名   method配置请求方法</p>
<p>​                      @RequestMapping(value&#x3D;”&#x2F;hi”,method &#x3D; RequestMethod.GET)</p>
<p>​                       注意：当浏览器出现404 可能是因为包扫描路径有问题</p>
<p>​                                 当浏览器出现405 是因为请求方法不允许 比如在浏览器上输入的路径访问，都是get请求，不能用post方法接受                                                                                                      这时候你要看@RequestMapping上面method属性配置的方法</p>
<h3 id="3）-RequestBody"><a href="#3）-RequestBody" class="headerlink" title="3）@RequestBody"></a>3）@RequestBody</h3><p>注解用于将Http<strong>请求体</strong>中的数据绑定到Controller方法的参数上。</p>
<p><img src="/images/image-20241029152736494.png" alt="javaweb架构图"></p>
<p>​              GET和POST的区别： get是将请求参数拼接在请求路径上，而post是将请求参数存放在请求体中。</p>
<h3 id="4）-ResponseBody"><a href="#4）-ResponseBody" class="headerlink" title="4）@ResponseBody"></a>4）@ResponseBody</h3><p> 将数据以 JSON 或 XML 格式直接返回给客户端（浏览器）,不会再去WEB-INF下面去找对应jsp文件</p>
<h3 id="5）-ResController-RequestBody-ResponseBody"><a href="#5）-ResController-RequestBody-ResponseBody" class="headerlink" title="5）@ResController&#x3D;@RequestBody+@ResponseBody"></a>5）@ResController&#x3D;@RequestBody+@ResponseBody</h3><p><strong>@RequestMapping的4个特例：</strong></p>
<h3 id="6-GetMapping-“-xxx”"><a href="#6-GetMapping-“-xxx”" class="headerlink" title="6)  @GetMapping( “&#x2F;xxx”)"></a>6)  @GetMapping( “&#x2F;xxx”)</h3><p> 相当于@RequestMapping(value &#x3D; “&#x2F;xxx”, method &#x3D; RequestMethod.GET) 用于处理HTTP GET请求。</p>
<h3 id="7-PostMapping-“-xxx”"><a href="#7-PostMapping-“-xxx”" class="headerlink" title="7)  @PostMapping( “&#x2F;xxx”)"></a>7)  @PostMapping( “&#x2F;xxx”)</h3><h3 id="8-PutMapping-“-xxx”"><a href="#8-PutMapping-“-xxx”" class="headerlink" title="8)  @PutMapping( “&#x2F;xxx”)"></a>8)  @PutMapping( “&#x2F;xxx”)</h3><h3 id="9-DeleteMapping-“-xxx”"><a href="#9-DeleteMapping-“-xxx”" class="headerlink" title="9)  @DeleteMapping( “&#x2F;xxx”)"></a>9)  @DeleteMapping( “&#x2F;xxx”)</h3><h3 id="10）-PathVariable"><a href="#10）-PathVariable" class="headerlink" title="10）@PathVariable"></a><strong>10）</strong>@PathVariable</h3><p><strong>用于从请求的 URL 中提取参数值，并将这些参数值注入到方法的参数中。</strong></p>
<p><img src="/images/image-20241029154022890.png" alt="javaweb架构图"></p>
<p>​                  <img src="/images/image-20241029154041447.png" alt="javaweb架构图"></p>
<h3 id="11）-RequestParam"><a href="#11）-RequestParam" class="headerlink" title="11）@RequestParam"></a><strong>11）</strong>@RequestParam</h3><p> 用于从 HTTP 请求中提取请求参数的值，并将这些值绑定到方法的参数。它主要用于处理<strong>查询参数（Query Parameters）和表单参数（Form Parameters）。</strong></p>
<p><img src="/images/image-20241104122957040.png" alt="javaweb架构图"></p>
<h1 id="三-SpringBoot"><a href="#三-SpringBoot" class="headerlink" title="三.SpringBoot"></a>三.SpringBoot</h1><p>SpringBoot核心思想：约定大于配置</p>
<p>SpringBoot用于简化Spring应用开发的新框架 </p>
<h2 id="1-怎样创建一个SpringBoot项目"><a href="#1-怎样创建一个SpringBoot项目" class="headerlink" title="1.怎样创建一个SpringBoot项目"></a>1.怎样创建一个SpringBoot项目</h2><h3 id="1）第一种方式"><a href="#1）第一种方式" class="headerlink" title="1）第一种方式"></a>1）第一种方式</h3><p>1.创建一个Maven项目</p>
<p><img src="/images/image-20241105150927491.png%22" alt="javaweb架构图"></p>
<p>2.导入依赖</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">3.3</span><span class="number">.5</span>&lt;/version&gt;</span><br><span class="line">    &lt;type&gt;pom&lt;/type&gt;</span><br><span class="line">    &lt;scope&gt;<span class="keyword">import</span>&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- https:<span class="comment">//mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-web --&gt;</span></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">3.3</span><span class="number">.5</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2）第二种方式-推荐"><a href="#2）第二种方式-推荐" class="headerlink" title="2）第二种方式(推荐)"></a>2）第二种方式(推荐)</h3><p>打开<a target="_blank" rel="noopener" href="https://start.spring.io/%E7%BD%91%E5%9D%80">https://start.spring.io/网址</a></p>
<p><img src="/images/image-20241105153214903.png" alt="javaweb架构图"></p>
<p><img src="/images/image-20241105153310701.png" alt="javaweb架构图"></p>
<p><img src="/images/image-20241105153331173.png" alt="javaweb架构图"></p>
<p>将压缩包下载解压，放入项目文件</p>
<p><img src="/images/image-20241105154610967.png" alt="javaweb架构图"></p>
<p><img src="/images/image-20241105154016012.png" alt="javaweb架构图"></p>
<p>只保留src+pom.xml文件，其余删除</p>
<p><img src="/images/image-20241105153629974.png" alt="javaweb架构图"></p>
<p><img src="/images/image-20241105154436348.png%22" alt="javaweb架构图"></p>
<h3 id="3）第三种方式（更加推荐-）"><a href="#3）第三种方式（更加推荐-）" class="headerlink" title="3）第三种方式（更加推荐***）"></a>3）第三种方式（更加推荐***）</h3><p><img src="/images/image-20241105155104390.png" alt="javaweb架构图"></p>
<p><img src="/images/image-20241105155125608.png" alt="javaweb架构图"></p>
<p>只保留Src和pom.xml文件，其余删除</p>
<p><img src="/images/image-20241105155304261.png" alt="javaweb架构图"></p>
<h2 id="2-JAVAWEB应用程序目录说明"><a href="#2-JAVAWEB应用程序目录说明" class="headerlink" title="2.JAVAWEB应用程序目录说明"></a>2.JAVAWEB应用程序目录说明</h2><p><img src="/images/image-20241105155943530.png" alt="javaweb架构图"></p>
<h2 id="注意：SpringBoot自动配置了包扫描，扫描的路径是启动类所在的包下"><a href="#注意：SpringBoot自动配置了包扫描，扫描的路径是启动类所在的包下" class="headerlink" title="注意：SpringBoot自动配置了包扫描，扫描的路径是启动类所在的包下"></a>注意：SpringBoot自动配置了包扫描，扫描的路径是启动类所在的包下</h2><h1 id="四-配置文件"><a href="#四-配置文件" class="headerlink" title="四.配置文件"></a>四.配置文件</h1><h2 id="1）配置文件-2种形式"><a href="#1）配置文件-2种形式" class="headerlink" title="1）配置文件(2种形式)"></a>1）配置文件(2种形式)</h2><p>配置文件主要用于配置应用程序的各种属性和行为，Spring Boot支持多种类型的配置文件，常见的有两种：<strong>.properties文件和.yml文件</strong>，<strong>名称是固定的都是以application开头</strong>。一般推荐使用.yml类型的配置文件，因为其采用层次结构，配置信息简洁清晰。</p>
<p>1.application.properties文件格式</p>
<p>​     以键值对形式。</p>
<pre><code>         <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server.port=<span class="number">8080</span></span><br></pre></td></tr></table></figure>
</code></pre>
<p><strong>2.application.yml文件格式（推荐使用）</strong></p>
<p>用首行缩进的格式（2个空格缩进），并且属性和属性值之间必须有一个空格隔开，属性和值的配置对大小写敏感</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line">  port: <span class="number">8080</span></span><br></pre></td></tr></table></figure>

<h2 id="2）配置文件绑定"><a href="#2）配置文件绑定" class="headerlink" title="2）配置文件绑定"></a>2）<strong>配置文件绑定</strong></h2><p>从配置文件中读取数据为实体类赋值：<strong>通过setter方法绑定</strong>（掌握），通过构造器方法绑定（了解），Bean配置绑定（了解）</p>
<p>在yml文件种配置</p>
<p><img src="/images/image-20241112163502112.png" alt="javaweb架构图"></p>
<p>在类上使用</p>
<p><img src="/images/image-20241112163535979.png" alt="javaweb架构图"></p>
<h2 id="3）多环境配置文件"><a href="#3）多环境配置文件" class="headerlink" title="3）多环境配置文件"></a>3）多环境配置文件</h2><p>Spring Boot支持使用多个配置文件区分不同的开发环境，dev开发环境，test测试环境，prod正式环境。</p>
<p>注意：在springboot中，项目只认application命名的配置文件，其余都不会认，可以通过application激活不同的开发环境的配置，来测试端口号。</p>
<p>多环境配置文件：</p>
<p><img src="/images/image-20241112163746173.png%22" alt="javaweb架构图"></p>
<p>新建主配置文件：application.yml，根据实际情况选择激活对应的配置文件，例如下面的配置是激活测试环境的配置文件</p>
<p><img src="/images/image-20241112163934406.png" alt="javaweb架构图"></p>
<h2 id="4）Environment"><a href="#4）Environment" class="headerlink" title="4）Environment"></a>4）Environment</h2><p>Environment 是Spring Boot中一个非常重要的接口，用于管理应用程序的环境属性。可以通过该对象访问项目的各种配置属性，包括系统属性、环境变量、配置文件中的属性等。</p>
<p>String port &#x3D; environment.getProperty(“server.port”); 可以获取端口号</p>
<h2 id="5）配置文件导入"><a href="#5）配置文件导入" class="headerlink" title="5）配置文件导入"></a>5）配置文件导入</h2><p><img src="/images/image-20241112164136546.png" alt="javaweb架构图"></p>
<p><img src="/images/image-20241112164146821.png" alt="javaweb架构图"></p>
<p><img src="/images/image-20241112164202970.png" alt="javaweb架构图"></p>
<p>测试文件是否被导入，只需要通过Environment去获取文件中的各种信息</p>
<h2 id="6）配置文件优先级"><a href="#6）配置文件优先级" class="headerlink" title="6）配置文件优先级"></a>6）配置文件优先级</h2><p><img src="/images/image-20241112164501566.png" alt="javaweb架构图"></p>
<h2 id="补充知识点"><a href="#补充知识点" class="headerlink" title="补充知识点*"></a>补充知识点*</h2><h2 id="1-如何导jar包"><a href="#1-如何导jar包" class="headerlink" title="1.如何导jar包"></a>1.如何导jar包</h2><p><img src="/images/image-20241112164632910.png%22" alt="javaweb架构图"></p>
<p>点击package</p>
<p><img src="/images/image-20241112164732327.png%22" alt="javaweb架构图"></p>
<p>控制台出现BUILD SUCCESS 说明jar包打包完毕。</p>
<p><img src="/images/image-20241112164832328.png" alt="javaweb架构图"></p>
<p>找到jar包，打开jar所在文件夹</p>
<p><img src="/images/image-20241112164919143.png" alt="javaweb架构图"></p>
<h2 id="2-如何通过命令行运行jar包"><a href="#2-如何通过命令行运行jar包" class="headerlink" title="2.如何通过命令行运行jar包"></a>2.如何通过命令行运行jar包</h2><p>在文件路径上输入cmd,输入指令运行jar包。</p>
<p><img src="/images/image-20241112165219419.png" alt="javaweb架构图"></p>
<p>也可以在后面跟上server.sport&#x3D;端口号，用于指定项目运行的端口号</p>
<p><img src="/images/image-20241112165346839.png" alt="javaweb架构图"></p>
<h2 id="3-Lombox简化工具"><a href="#3-Lombox简化工具" class="headerlink" title="3.Lombox简化工具"></a>3.Lombox简化工具</h2><p><a target="_blank" rel="noopener" href="https://projectlombok.org/">Lombok</a> 是一款用于 Java 语言的开发工具，旨在通过注解简化 Java 代码的编写。使用 Lombok，可以通过注解自动生成一些样板代码，如 Getter、Setter、构造函数等，从而减少冗长的代码，提高开发效率。</p>
<ul>
<li><p>@Getter 注解用于自动生成 getter 方法。</p>
</li>
<li><p>@Setter 注解用于自动生成 setter 方法。</p>
</li>
<li><p>@NoArgsConstructor 自动生成无参构造函数。</p>
</li>
<li><p>@AllArgsConstructor 自动生成包含所有字段的构造函数。</p>
</li>
<li><p>@Data是一个组合注解， 包含 <strong>@Getter、@Setter、@ToString</strong>、@EqualsAndHashCode 和 @RequiredArgsConstructor 的功能。</p>
<p>Lombox的依赖：</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">1.18</span><span class="number">.34</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/images/image-20241119143634378.png" alt="javaweb架构图"></p>
<h1 id="五-MyBatis"><a href="#五-MyBatis" class="headerlink" title="五.MyBatis"></a>五.MyBatis</h1><h2 id="1-使用方式"><a href="#1-使用方式" class="headerlink" title="1.使用方式"></a>1.使用方式</h2><h3 id="1）Mapper接口-XML映射文件（更加灵活）"><a href="#1）Mapper接口-XML映射文件（更加灵活）" class="headerlink" title="1）Mapper接口+XML映射文件（更加灵活）"></a>1）Mapper接口+XML映射文件（更加灵活）</h3><p>每个Mapper接口都有一个对应的XML文件，其中定义了SQL语句和结果映射。</p>
<h3 id="2）Mapper接口-注解"><a href="#2）Mapper接口-注解" class="headerlink" title="2）Mapper接口+注解"></a>2）Mapper接口+注解</h3><h2 id="2-使用Spring-Boot整合Mybatis"><a href="#2-使用Spring-Boot整合Mybatis" class="headerlink" title="2.使用Spring Boot整合Mybatis"></a>2.使用Spring Boot整合Mybatis</h2>
    </article>
    
    <div class="read-nums">
      <!-- id 将作为查询条件 -->
      <span id="2024/11/27/JAVAWEB框架/" class="leancloud_visitors" data-flag-title="Your Article Title">
        <em class="post-meta-item-text">浏览量</em>
        <i class="leancloud-visitors-count"></i>
      </span>
    </div>
    <div class="comments-intro">
      <h2>评论区</h2>
      <p>欢迎你留下宝贵的意见，昵称输入QQ号会显示QQ头像哦~</p>
    </div>
    <div id="vcomments" class="vcomments"></div>
    
  </div>
  <div class="article-catelogue">
    <div class="article-catelogue--wrapper">
      <div class="catelogue catelogue-1">
        <h3>目录</h3>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#JAVAWEB%E6%A1%86%E6%9E%B6"><span class="toc-number">1.</span> <span class="toc-text">JAVAWEB框架</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80-%E5%AD%A6%E4%B9%A0spring"><span class="toc-number">2.</span> <span class="toc-text">一.学习spring</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%BA%86%E8%A7%A3Spring"><span class="toc-number">2.1.</span> <span class="toc-text">1.了解Spring</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAspring%E9%A1%B9%E7%9B%AE"><span class="toc-number">2.2.</span> <span class="toc-text">2.创建一个spring项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Spring%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6application-xml-5%E4%B8%AA%E6%A0%87%E7%AD%BE"><span class="toc-number">2.3.</span> <span class="toc-text">3.Spring配置文件application.xml(5个标签)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E8%8E%B7%E5%8F%96bean%E5%AF%B9%E8%B1%A1%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">2.4.</span> <span class="toc-text">4.获取bean对象三种方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89%E4%BC%A0%E5%85%A5id"><span class="toc-number">2.4.1.</span> <span class="toc-text">1）传入id</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%B1%BB-class%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.4.2.</span> <span class="toc-text">2)类.class类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%EF%BC%89id-%E7%B1%BB-class-%E5%B8%B8%E7%94%A8"><span class="toc-number">2.4.3.</span> <span class="toc-text">3）id,类.class(常用)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%EF%BC%885%E4%B8%AA%E9%98%B6%E6%AE%B5%EF%BC%89"><span class="toc-number">2.5.</span> <span class="toc-text">5.bean的生命周期（5个阶段）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%EF%BC%887%E4%B8%AA%E9%98%B6%E6%AE%B5%E2%80%93%E9%87%8D%E7%82%B9%E6%8E%8C%E6%8F%A1%EF%BC%89"><span class="toc-number">2.6.</span> <span class="toc-text">6.bean的生命周期（7个阶段–重点掌握）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-bean%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">2.7.</span> <span class="toc-text">7.bean的作用域</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-IOC%EF%BC%88%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC%EF%BC%89"><span class="toc-number">2.8.</span> <span class="toc-text">8.IOC（控制反转）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-DI%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A52%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">2.9.</span> <span class="toc-text">9.DI依赖注入2种方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89%E6%9E%84%E9%80%A0%E5%99%A8%E6%B3%A8%E5%85%A5%EF%BC%88%E6%9C%89%E5%8F%82%EF%BC%89constructor-arg"><span class="toc-number">2.9.1.</span> <span class="toc-text">1）构造器注入（有参）constructor-arg</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%89setter%E6%96%B9%E6%B3%95%E6%B3%A8%E5%85%A5-property"><span class="toc-number">2.9.2.</span> <span class="toc-text">2）setter方法注入 property</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="toc-number">2.10.</span> <span class="toc-text">10.自动装配</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-Spring%E6%B3%A8%E8%A7%A3"><span class="toc-number">2.11.</span> <span class="toc-text">11.Spring注解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89%E4%BD%BF%E7%94%A8%E5%85%A8%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F%E5%BC%80%E5%8F%91"><span class="toc-number">2.11.1.</span> <span class="toc-text">1）使用全注解方式开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%89%E6%B3%A8%E8%A7%A3"><span class="toc-number">2.11.2.</span> <span class="toc-text">2）注解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%EF%BC%89%E5%B8%B8%E7%94%A8%E7%9A%84Spring%E6%A1%86%E6%9E%B6%E6%B3%A8%E8%A7%A3%E5%8F%8A%E5%85%B6%E7%94%A8%E9%80%94%EF%BC%9A"><span class="toc-number">2.11.3.</span> <span class="toc-text">3）常用的Spring框架注解及其用途：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%91%E5%A3%B0%E5%90%8DBean%E7%9A%84%E6%B3%A8%E8%A7%A3"><span class="toc-number">2.11.3.1.</span> <span class="toc-text">1】声名Bean的注解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%91%E6%B3%A8%E5%85%A5%E5%B1%9E%E6%80%A7%E5%80%BC"><span class="toc-number">2.11.3.2.</span> <span class="toc-text">2】注入属性值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%91%E5%85%B6%E4%BB%96%E7%9A%84"><span class="toc-number">2.11.3.3.</span> <span class="toc-text">3】其他的</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%EF%BC%89%E6%B3%A8%E8%A7%A3%E6%80%BB%E7%BB%93%E5%9B%BE"><span class="toc-number">2.11.4.</span> <span class="toc-text">4）注解总结图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-AOP"><span class="toc-number">2.12.</span> <span class="toc-text">12.AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">2.12.1.</span> <span class="toc-text">1）基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%89%E4%BD%BF%E7%94%A8AOP%E6%AD%A5%E9%AA%A4%EF%BC%9A"><span class="toc-number">2.12.2.</span> <span class="toc-text">2）使用AOP步骤：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-JDBCTemplate"><span class="toc-number">2.13.</span> <span class="toc-text">13.JDBCTemplate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-%E6%A1%86%E6%9E%B6%E6%8F%90%E4%BE%9B%E7%9A%84%E4%B8%80%E4%B8%AA%E7%94%A8%E4%BA%8E%E7%AE%80%E5%8C%96-JDBC-%E7%BC%96%E7%A8%8B%E7%9A%84%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-number">2.14.</span> <span class="toc-text">(Spring 框架提供的一个用于简化 JDBC 编程的工具类)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89%E5%86%99%E4%B8%80%E4%B8%AAJDBC%E5%B7%A5%E5%85%B7%E7%B1%BB%E7%9A%84%E6%AD%A5%E9%AA%A4%EF%BC%9A"><span class="toc-number">2.14.1.</span> <span class="toc-text">1）写一个JDBC工具类的步骤：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%89%E4%BD%BF%E7%94%A8JDBC-Template%E7%9A%84%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.14.2.</span> <span class="toc-text">2）使用JDBC Template的步骤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C-Spring-MVC"><span class="toc-number">3.</span> <span class="toc-text">二.Spring MVC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%89%8D%E6%99%AF%E7%9F%A5%E8%AF%86"><span class="toc-number">3.1.</span> <span class="toc-text">1.前景知识</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%9B%9E%E9%A1%BEServlet"><span class="toc-number">3.2.</span> <span class="toc-text">2.回顾Servlet</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAServlet%E9%A1%B9%E7%9B%AE"><span class="toc-number">3.2.1.</span> <span class="toc-text">创建Servlet项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2Tomcat"><span class="toc-number">3.2.2.</span> <span class="toc-text">部署Tomcat</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-SpringMvc%E5%B8%B8%E7%94%A8%E5%BC%80%E5%8F%91%E6%B3%A8%E8%A7%A3"><span class="toc-number">3.3.</span> <span class="toc-text">3.*SpringMvc常用开发注解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89-Controller"><span class="toc-number">3.3.1.</span> <span class="toc-text">1）@Controller</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%89-RequestMapping"><span class="toc-number">3.3.2.</span> <span class="toc-text">2）@RequestMapping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%EF%BC%89-RequestBody"><span class="toc-number">3.3.3.</span> <span class="toc-text">3）@RequestBody</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%EF%BC%89-ResponseBody"><span class="toc-number">3.3.4.</span> <span class="toc-text">4）@ResponseBody</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%EF%BC%89-ResController-RequestBody-ResponseBody"><span class="toc-number">3.3.5.</span> <span class="toc-text">5）@ResController&#x3D;@RequestBody+@ResponseBody</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-GetMapping-%E2%80%9C-xxx%E2%80%9D"><span class="toc-number">3.3.6.</span> <span class="toc-text">6)  @GetMapping( “&#x2F;xxx”)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-PostMapping-%E2%80%9C-xxx%E2%80%9D"><span class="toc-number">3.3.7.</span> <span class="toc-text">7)  @PostMapping( “&#x2F;xxx”)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-PutMapping-%E2%80%9C-xxx%E2%80%9D"><span class="toc-number">3.3.8.</span> <span class="toc-text">8)  @PutMapping( “&#x2F;xxx”)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-DeleteMapping-%E2%80%9C-xxx%E2%80%9D"><span class="toc-number">3.3.9.</span> <span class="toc-text">9)  @DeleteMapping( “&#x2F;xxx”)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10%EF%BC%89-PathVariable"><span class="toc-number">3.3.10.</span> <span class="toc-text">10）@PathVariable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11%EF%BC%89-RequestParam"><span class="toc-number">3.3.11.</span> <span class="toc-text">11）@RequestParam</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89-SpringBoot"><span class="toc-number">4.</span> <span class="toc-text">三.SpringBoot</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%80%8E%E6%A0%B7%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AASpringBoot%E9%A1%B9%E7%9B%AE"><span class="toc-number">4.1.</span> <span class="toc-text">1.怎样创建一个SpringBoot项目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">4.1.1.</span> <span class="toc-text">1）第一种方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%89%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%96%B9%E5%BC%8F-%E6%8E%A8%E8%8D%90"><span class="toc-number">4.1.2.</span> <span class="toc-text">2）第二种方式(推荐)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%EF%BC%89%E7%AC%AC%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F%EF%BC%88%E6%9B%B4%E5%8A%A0%E6%8E%A8%E8%8D%90-%EF%BC%89"><span class="toc-number">4.1.3.</span> <span class="toc-text">3）第三种方式（更加推荐***）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-JAVAWEB%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%9B%AE%E5%BD%95%E8%AF%B4%E6%98%8E"><span class="toc-number">4.2.</span> <span class="toc-text">2.JAVAWEB应用程序目录说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%EF%BC%9ASpringBoot%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E4%BA%86%E5%8C%85%E6%89%AB%E6%8F%8F%EF%BC%8C%E6%89%AB%E6%8F%8F%E7%9A%84%E8%B7%AF%E5%BE%84%E6%98%AF%E5%90%AF%E5%8A%A8%E7%B1%BB%E6%89%80%E5%9C%A8%E7%9A%84%E5%8C%85%E4%B8%8B"><span class="toc-number">4.3.</span> <span class="toc-text">注意：SpringBoot自动配置了包扫描，扫描的路径是启动类所在的包下</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">5.</span> <span class="toc-text">四.配置文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%EF%BC%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-2%E7%A7%8D%E5%BD%A2%E5%BC%8F"><span class="toc-number">5.1.</span> <span class="toc-text">1）配置文件(2种形式)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%EF%BC%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%BB%91%E5%AE%9A"><span class="toc-number">5.2.</span> <span class="toc-text">2）配置文件绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%EF%BC%89%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">5.3.</span> <span class="toc-text">3）多环境配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%EF%BC%89Environment"><span class="toc-number">5.4.</span> <span class="toc-text">4）Environment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%EF%BC%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%AF%BC%E5%85%A5"><span class="toc-number">5.5.</span> <span class="toc-text">5）配置文件导入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%EF%BC%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">5.6.</span> <span class="toc-text">6）配置文件优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">5.7.</span> <span class="toc-text">补充知识点*</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A6%82%E4%BD%95%E5%AF%BCjar%E5%8C%85"><span class="toc-number">5.8.</span> <span class="toc-text">1.如何导jar包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%BF%90%E8%A1%8Cjar%E5%8C%85"><span class="toc-number">5.9.</span> <span class="toc-text">2.如何通过命令行运行jar包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Lombox%E7%AE%80%E5%8C%96%E5%B7%A5%E5%85%B7"><span class="toc-number">5.10.</span> <span class="toc-text">3.Lombox简化工具</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94-MyBatis"><span class="toc-number">6.</span> <span class="toc-text">五.MyBatis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">6.1.</span> <span class="toc-text">1.使用方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89Mapper%E6%8E%A5%E5%8F%A3-XML%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6%EF%BC%88%E6%9B%B4%E5%8A%A0%E7%81%B5%E6%B4%BB%EF%BC%89"><span class="toc-number">6.1.1.</span> <span class="toc-text">1）Mapper接口+XML映射文件（更加灵活）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%89Mapper%E6%8E%A5%E5%8F%A3-%E6%B3%A8%E8%A7%A3"><span class="toc-number">6.1.2.</span> <span class="toc-text">2）Mapper接口+注解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E4%BD%BF%E7%94%A8Spring-Boot%E6%95%B4%E5%90%88Mybatis"><span class="toc-number">6.2.</span> <span class="toc-text">2.使用Spring Boot整合Mybatis</span></a></li></ol></li></ol>
      </div>
      
        <div class="catelogue catelogue-2">
          
            <p>
              <span>上一篇：</span>
              <a href="/2025/03/27/学习Redis/">学习Redis</a>
            </p>
           
          
            <p>
              <span>下一篇</span>
              <a href="/2024/09/09/微信小程序/">微信小程序</a>
            </p>
          
        </div>
      
    </div>
  </div>
</div>


<script>
  // var定义，避免pjax重新进来造成的重复声明错误
  var config = JSON.parse('{"enable":true,"appId":"Pf8zCXGEH1qsprnWfikVVujL-gzGzoHsz","appKey":"qOqoiUHhH1TGtLRUYURkLRQX","placeholder":"请留下你宝贵的意见吧~","meta":["nick"],"recordIP":true,"visitor":true,"enableQQ":true}')
  new Valine({
    el: '#vcomments',
    appId: config.appId,
    appKey: config.appKey,
    placeholder: config.placeholder,
    meta: config.meta,
    recordIP: config.recordIP,
    visitor: config.visitor,
    enableQQ: config.enableQQ,
    path: '2024/11/27/JAVAWEB框架/'
  })
</script>


<script>
  $(document).on('pjax:complete', function() {
    const tocs = document.querySelector('.toc')
    const links = tocs ? tocs.querySelectorAll('a') : []
    links.forEach(link => {
      link.addEventListener('click', e => {
        const href = decodeURIComponent(e.href)
        href.search(/#(.*)/)
        const id = RegExp.$1
        const target = document.querySelector('#' + id)
        const top = target.offsetTop
        document.documentElement.scrollTo({
          top: top - 100,
          behavior: 'smooth'
        })
        e.preventDefault()
      })
    })
  })
</script> 

</div>
      <div class="main-right-wrapper"><div class="main-right">
  <div class="main-right--board">
    <div class="main-right--title">
      <h5>公告栏</h5>
      <i class="iconfont icon-gonggao"></i>
    </div>
    <div class="main-right--content">
      Hello~大噶好。我是gcbsh，欢迎你们来到我的博客小站，希望能在这里收获到有用的东西哦！ 
    </div>
  </div>

  <div id="aplayer" class="main-right--music"></div>

  <div class="operate-items">
    <div class="operate-item backtop">
      <i class="iconfont icon-huidaodingbu"></i>
      <span>回到顶部</span>
    </div>
    
    <div class="operate-item turn-comment hidden">
      <i class="iconfont icon-pinglun"></i>
      <span>查看评论</span>
    </div>
    
  </div>

  <div class="main-right--site">
    <div class="main-right--power">
      <p>Power By <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">Hexo</a>.</p>
      <p>Theme：<a target="_blank" rel="noopener" href="https://github.com/Aizener/hexo-theme-cola">Cola.</a></p>
    </div>
    <p class="main-right--refer"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/#/Integrated/index">蜀ICP备2022005384号-1</a> </p>
  </div>
</div>

<script>
  function setOperateItem () {
    const reg = /\d{4}\/\d{2}\/\d{2}\/.+/
    const path = location.pathname
    const operateDom = document.querySelector('.main-right .operate-items')
    const commentDom = document.querySelector('.turn-comment')
    const cateloguDom = document.querySelector('.article-catelogue > .article-catelogue--wrapper');

    if (commentDom) {
      if (reg.test(path) || path.match(/\/log\/.+/)) {
        commentDom.classList.remove('hidden')
        const newDom = operateDom.cloneNode(true);
        const _backtopDom = newDom.querySelector('.backtop');
        const _commentDom = newDom.querySelector('.turn-comment');
        _backtopDom.addEventListener('click', () => backTopEvent());
        _commentDom.addEventListener('click', () => commentDomEvent());
        cateloguDom.appendChild(newDom);
      } else {
        commentDom.classList.add('hidden')
      }
    }
  }

  setOperateItem()
  const musics = JSON.parse(`[{"name":"去有风的地方","artist":"郁可唯","url":"music/quyoufengdedifang.mp3","cover":"/imgs/quyoufengdedifang.jpg"},{"name":"消失","artist":"苏运莹","url":"music/xiaoshi.mp3","cover":"/imgs/xiaoshi.jpg"}]`)
  const ap = new APlayer({
    container: document.querySelector('#aplayer'),
    audio: musics,
  })

  $(document).on('pjax:complete', function() {
    setOperateItem()
  })

  document.querySelector('.backtop').addEventListener('click', () => {
    backTopEvent();
  })
  const dom = document.querySelector('.turn-comment')
  dom && dom.addEventListener('click', () => {
    commentDomEvent();
  })

  function backTopEvent() {
    document.documentElement.scrollTo({
      top: 0,
      behavior: 'smooth'
    })
  }

  function commentDomEvent() {
    const commentDom = document.querySelector('.comments-intro')
    if (!commentDom) return
    const top = commentDom.offsetTop, height = commentDom.offsetHeight
    document.documentElement.scrollTo({
      top: top - 2 * height,
      behavior: 'smooth'
    })
  }
</script></div>
    </section>
  </div>
  <div id="progress" class="progress"></div>
  <div id="gray" class="gray"></div>

  <script>
    function initScroll () {
      document.addEventListener('scroll', () => {
        const doc = document.documentElement
        const scrollTop = doc.scrollTop
        const pageHeight = doc.offsetHeight
        const clientHeight = doc.clientHeight
        const ratio = scrollTop / (pageHeight - clientHeight)
        const progress = document.querySelector('#progress')
        const avatarImg = document.querySelector('.main-left--avatar')
        progress.style.width = (100 * ratio) + '%'
        avatarImg.style.transform = `rotate(${360 * ratio}deg)`
      })
    }

    const rootPath = "/"

    const checkAndSetArticlePageLayout = () => {
      const path = location.pathname.replace(rootPath, '');
      if (
        /^\/?\d{4}\/\d{2}\/\d{2}\/.*/.test(path) ||
        /^log\/.+/.test(path)
      ) {
        $('.main-container, .main-right, .main-right-wrapper').addClass('is-article')
      } else {
        $('.main-container, .main-right, .main-right-wrapper').removeClass('is-article')
      }
    }

    const gray = "none"
    const setGrayStyle = () => {
      if (gray === 'none') {
        return
      } else if (gray === 'index') {
        location.pathname === '/' ? $('#gray').show() : $('#gray').hide()
      } else if (gray === 'all') {
        $('#gray').show()
      }
    }
    setGrayStyle()


    window.onload = function () {
      checkAndSetArticlePageLayout()
      setTimeout(() => {
        $('#load').slideUp()
        $('#container').slideToggle()
        setTimeout(() => {
          initScroll();
        }, 500)
      }, 500)
    }
    
    let status = 0
    // 对所有链接跳转事件绑定pjax容器container
    $(document).pjax('a[target!=_blank]', '#main-container', {
      container: '#main-container',
      fragment: '#main-container',
      timeout: 8000
    })

    $(document).on('pjax:start', function() {
    })
    $(document).on('pjax:complete', function() {
      status = 0
      $('.main-container').addClass('to-up').on('animationend', function() {
        $(this).removeClass('to-up')
      })
      setGrayStyle()
      checkAndSetArticlePageLayout()
    })
    $(document).on('pjax:popstate', function() {
      status = -1
      checkAndSetArticlePageLayout()
    });
  </script>
</body>
</html>